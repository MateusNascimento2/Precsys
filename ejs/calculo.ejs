<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>

  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="md:max-w-[768px] md:m-auto">
  <form class="p-2">
    <h2 class="text-lg font-bold mb-4 text-center">Modelo de Cálculo</h2>
    <div>
      <input class="border-b-[1px] border-gray-300 px-2 py-1 mb-4 w-full" type="text" name="numeroPrecatorio"
        id="numeroPrecatorio" placeholder="Numero do precatório">
    </div>
    <div>
      <input class="border-b-[1px] border-gray-300 px-2 py-1 mb-4 w-full" type="text" name="database" id="database"
        placeholder="Database" maxlength="10">
    </div>
    <div>
      <input class="border-b-[1px] border-gray-300 px-2 py-1 mb-4 w-full" type="text" name="valor-principal"
        id="valor-principal" placeholder="Valor principal">
    </div>
    <div>
      <input class="border-b-[1px] border-gray-300 px-2 py-1 mb-4 w-full" type="text" name="valor-juros"
        id="valor-juros" placeholder="Valor dos juros">
    </div>
    <fieldset class="mb-4">
      <legend class="mb-2">Pagamentos pleiteados:</legend>
      <div class="flex flex-col md:flex-row md:items-center">
        <label class="md:mr-2" for="data-inicio">Data de início:</label>
        <input class="border-b-[1px] border-gray-300 px-2 py-1 mt-2 mb-2 md:mr-10" type="date" name="data-inicio" id="data-inicio">
        <label class="md:mr-2" for="data-final">Data final:</label>
        <input class="border-b-[1px] border-gray-300 px-2 py-1 mt-2 mb-2" type="date" name="data-final" id="data-final">
      </div>
    </fieldset>
    <div>
      <input class="border-b-[1px] border-gray-300 px-2 py-1 mb-4 w-full" type="text" name="ano-orcamento"
        id="ano-orcamento" placeholder="Ano do orçamento">
    </div>
    <div class="text-center">
      <input type="submit" value="Enviar" class="bg-gray-200 px-3 rounded cursor-pointer">
    </div>
  </form>

  <div class="p-2 md:max-w-[768px] md:m-auto">
    <table class="mt-10 w-full m-auto">
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left">Data do cálculo</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center"><span>29/06/2016</span></td>
      </tr>
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left">Valor principal</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">76.417,96</td>
      </tr>
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left">Valor dos juros</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">19.316,83</td>
      </tr>
      <tr>
        <th class="py-2 px-8 text-left">Valor bruto</th>
        <td class="py-2 px-8 text-center">95.734,79</td>
      </tr>
    </table>

    <table class="mt-10 w-full m-auto">
      <tr class="border-b-[1px] border-black">
        <th class="py-2 px-8" colspan="2"><span>29/06/2016</span> a <span>01/07/2018</span></th>
      </tr>
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left">IPCA-E</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">1,077588885</td>
      </tr>
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left">Valor principal</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">82.347,14</td>
      </tr>
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left">Valor dos juros - atualização</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">20.815,60</td>
      </tr>
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left" rowspan="2">Juros</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">11,14%</td>
      </tr>
      <tr>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">9.172,70</td>
      </tr>
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left">Valor principal</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">82.347,14</td>
      </tr>
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left">Valor dos juros</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">29.988,30</td>
      </tr>
      <tr>
        <th class="py-2 px-8 text-left">Valor bruto</th>
        <td class="py-2 px-8 text-center">112.335,45</td>
      </tr>
    </table>

    <table class="mt-10 w-full m-auto">
      <tr class="border-b-[1px] border-black">
        <th class="py-2 px-8" colspan="2"><span>01/07/2018</span> a <span>31/12/2019</span> (período da graça)</th>
      </tr>
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left">IPCA-E</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">1,043519498</td>
      </tr>
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left">Valor principal</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">85.930,85</td>
      </tr>
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left">Valor dos juros - atualização</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">31.293,38</td>
      </tr>
      <tr>
        <th class="py-2 px-8 text-left">Valor bruto</th>
        <td class="py-2 px-8 text-center">117.224,23</td>
      </tr>
    </table>

    <table class="mt-10 w-full m-auto">
      <tr class="border-b-[1px] border-black">
        <th class="py-2 px-8" colspan="2"><span>31/12/2019</span> a <span>01/12/2021</span></th>
      </tr>
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left">IPCA-E</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">1,154001106</td>
      </tr>
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left">Valor principal</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">99.164,30</td>
      </tr>
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left">Valor dos juros - atualização</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">36.112,60</td>
      </tr>
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left" rowspan="2">Juros</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">4,55%</td>
      </tr>
      <tr>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center text-left">4.510,79</td>
      </tr>
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left">Valor principal</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">99.164,30</td>
      </tr>
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left">Valor dos juros</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">40.623,38</td>
      </tr>
      <tr>
        <th class="py-2 px-8 text-left">Valor bruto</th>
        <td class="py-2 px-8 text-center">139.787,68</td>
      </tr>
    </table>

    <table class="mt-10 w-full m-auto">
      <tr class="border-b-[1px] border-black">
        <th class="py-2 px-8" colspan="2"><span>01/12/2021</span> a <span>01/03/2023</span></th>
      </tr>
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left" rowspan="2">SELIC</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">14,77%</td>
      </tr>
      <tr>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">14.646,57</td>
      </tr>
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left">Valor principal</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">99.164,30</td>
      </tr>
      <tr>
        <th class="border-b-[1px] border-gray-300 py-2 px-8 text-left">Valor dos juros</th>
        <td class="border-b-[1px] border-gray-300 py-2 px-8 text-center">55.269,95</td>
      </tr>
      <tr>
        <th class="py-2 px-8 text-left">Valor bruto</th>
        <td class="py-2 px-8 text-center">154.434,24</td>
      </tr>
    </table>
  </div>


  <script>

    const databaseInput = document.getElementById('database');

    databaseInput.addEventListener('keypress', (event) => {
      formatarDatabaseInput(databaseInput, event);
    })

    function formatarDatabaseInput(input, event) {
      if (event.keyCode < 47 || event.keyCode > 57) {
        event.preventDefault();
      }

      let valueLength = input.value.length;

      if (valueLength !== 1 || valueLength !== 3) {
        if (event.keyCode == 47) {
          event.preventDefault();
        }
      }

      if (valueLength === 2) {
        input.value += '/';
      }

      if (valueLength === 5) {
        input.value += '/';
      }
    }

    document.querySelector('form').addEventListener('submit', async (event) => {
      event.preventDefault();

      const formData = {
        database: document.getElementById('database').value,
        valorPrincipal: document.getElementById('valor-principal').value,
        valorJuros: document.getElementById('valor-juros').value,
        dataInicio: document.getElementById('data-inicio').value,
        dataFinal: document.getElementById('data-final').value,
        anoOrcamento: document.getElementById('ano-orcamento').value
      }

      const headersValorPrincipal = document.querySelectorAll('th');

      let anoOrcamento;

      if (formData.anoOrcamento === '2020') {
        anoOrcamento = '01/07/2019';
      } else if (formData.anoOrcamento === '2021') {
        anoOrcamento = '01/07/2020';
      } else if (formData.anoOrcamento === '2022') {
        anoOrcamento = '01/07/2021';
      } else if (formData.anoOrcamento === '2023') {
        anoOrcamento = '02/04/2022';
      } else if (formData.anoOrcamento === '2024') {
        anoOrcamento = '02/04/2023';
      }

      const tables = document.querySelectorAll('table');

      tables.forEach(table => {
        const primeiroSpan = table.querySelectorAll('span')[0];
        const segundoSpan = table.querySelectorAll('span')[1];

        if (primeiroSpan) {
          primeiroSpan.textContent = formData.database;
        }


        if (segundoSpan) {
          segundoSpan.textContent = anoOrcamento;
        }
      });

      headersValorPrincipal.forEach((header) => {
        if (header.textContent === 'Valor principal') {
          console.log(header);
          header.nextElementSibling.textContent = formData.valorPrincipal
        }

        if (header.textContent === 'Valor dos juros') {
          header.nextElementSibling.textContent = formData.valorJuros
        }

        if (header.textContent === 'Valor bruto') {
          header.nextElementSibling.textContent = Number(formData.valorPrincipal) + Number(formData.valorJuros)
        }
      })

      console.log(formData);

/*       const response = await fetch('./data.json')
      const result = await response.json();
      let data = result.filter((obj) => {
        return obj.Data === "jan/94"
      })
      console.log(data) */

      /*       const response = await fetch('http://localhost:3000/calculo', {
              method: 'POST',
              headers: {
                'content-type': 'application/json',
              },
              body: JSON.stringify(formData)
            })

            console.log(formData); */
    })
  </script>
</body>

</html>
